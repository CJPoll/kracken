#! /usr/bin/env ruby
require 'byebug'

current_dir = File.realdirpath(__FILE__)
puts current_dir

require "#{current_dir}/../../lib/concker/config"

class BadCLIArgumentException < StandardError; end

module Settings
  def self.load!(args)
    @no_deploy = []

    while args.length > 0 do
      raise BadCLIArgumentException unless args.shift == '--no-deploy'
      @no_deploy << args.shift
    end

  end

  def self.deploy?(app)
    !(@no_deploy.include?('all') || @no_deploy.include?(app))
  end
end

def main
  Settings.load!(ARGV.dup)
  config = Config.load

  config.create
end

main
